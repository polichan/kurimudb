import{o as n,c as s,a}from"./app.1f1a6988.js";const p='{"title":"æ¨¡å‹","description":"","frontmatter":{"sidebarDepth":2},"headers":[{"level":2,"title":"èµ·æ­¥","slug":"èµ·æ­¥"},{"level":2,"title":"åˆ›å»ºæ¨¡å‹","slug":"åˆ›å»ºæ¨¡å‹"},{"level":2,"title":"æ¨¡å‹æ–¹æ³•","slug":"æ¨¡å‹æ–¹æ³•"},{"level":2,"title":"é›†åˆæ¨¡å‹","slug":"é›†åˆæ¨¡å‹"},{"level":2,"title":"æ¨¡å‹å¡«å……","slug":"æ¨¡å‹å¡«å……"},{"level":2,"title":"æ·±å…‹éš†","slug":"æ·±å…‹éš†"},{"level":2,"title":"ç±» Storage Api","slug":"ç±»-storage-api"},{"level":2,"title":"å…¨éƒ¨æ•°æ®","slug":"å…¨éƒ¨æ•°æ®"}],"relativePath":"model.md","lastUpdated":1620272523235}',e={},t=a('<h1 id="æ¨¡å‹"><a class="header-anchor" href="#æ¨¡å‹" aria-hidden="true">#</a> æ¨¡å‹</h1><p>åœ¨å‰æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†åŸºç¡€ç”¨æ³•ï¼Œå¹¶ä½¿ç”¨äº† <code>kurimudb-zero-config</code> è¿™ä¸ªé›¶é…ç½®åŒ…ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™å·²ç»èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚å•¦ã€‚</p><p>å¯å¦‚æœæˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªå¤æ‚çš„å•é¡µåº”ç”¨çš„è¯ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼šæˆ‘ä»¬çœŸçš„è¦ï¼ŒæŠŠå„ç§æ•°æ®éƒ½ä¹±ç³Ÿç³Ÿåœ°å¡åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œå—ï¼Ÿè¿™å¯ä¸æ˜¯ä»€ä¹ˆå¥½åŠæ³•ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œå°±è¯¥ <strong>æ¨¡å‹ (Model) åŠŸèƒ½</strong> é—ªäº®ç™»åœºå•¦ï¼ ğŸ‰</p><h2 id="èµ·æ­¥"><a class="header-anchor" href="#èµ·æ­¥" aria-hidden="true">#</a> èµ·æ­¥</h2><p>æ¨¡å‹æ˜¯å­˜å‚¨å’Œç®¡ç†ä½ åº”ç”¨æ•°æ®çš„ä¸­å¿ƒï¼Œä¹‹å‰æˆ‘ä»¬ä½¿ç”¨çš„é›¶é…ç½®åŒ…ä¸­ï¼Œ<code>memory</code>ã€<code>local</code>ã€<code>cookie</code> å’Œ <code>db</code> å¯¹è±¡ï¼Œå…¶å®éƒ½æ˜¯æ¨¡å‹å“¦ï¼</p><p>ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå®‰è£… Kurimudb æœ¬ä½“å§ï¼š</p><div class="language-bash line-numbers-mode"><pre><code><span class="token function">npm</span> i kurimudb@3\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="åˆ›å»ºæ¨¡å‹"><a class="header-anchor" href="#åˆ›å»ºæ¨¡å‹" aria-hidden="true">#</a> åˆ›å»ºæ¨¡å‹</h2><p>åˆ›å»ºä¸€ä¸ªæ¨¡å‹å…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦ç»§æ‰¿ Kurimudb çš„æ¨¡å‹ç±»å³å¯ï¼š</p><div class="language-js line-numbers-mode"><pre><code><span class="token comment">// åˆ›å»ºä¸€ä¸ª /models/configState.js æ–‡ä»¶</span>\n<span class="token comment">// æˆ‘ä»¬å¯ä»¥æ‹¿å®ƒæ¥å­˜å’Œç”¨æˆ·é…ç½®æœ‰å…³çš„æ•°æ®</span>\n\n<span class="token keyword">import</span> <span class="token punctuation">{</span> Models <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;kurimudb&quot;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ConfigState</span> <span class="token keyword">extends</span> <span class="token class-name">Models<span class="token punctuation">.</span>keyValue</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      name<span class="token operator">:</span> <span class="token string">&quot;configState&quot;</span><span class="token punctuation">,</span> <span class="token comment">// æ¨¡å‹åç§°ï¼Œå¿…é¡»æ˜¯å”¯ä¸€çš„</span>\n      type<span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span> <span class="token comment">// æ¨¡å‹çš„ä¸»é”®ç±»å‹</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">ConfigState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>å¦‚æ­¤ï¼Œä½ å°±æ‹¥æœ‰äº†ä¸€ä¸ª <code>ConfigState</code> æ¨¡å‹ï¼Œå®ƒæ˜¯ä¸€ä¸ª <strong>é”®å€¼å¯¹æ¨¡å‹</strong>ï¼Œä½¿ç”¨æ—¶åˆ™æ›´åŠ ç®€å•ï¼š</p><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">import</span> configState <span class="token keyword">from</span> <span class="token string">&quot;./models/configState.js&quot;</span><span class="token punctuation">;</span>\n\nconfigState<span class="token punctuation">.</span>data<span class="token punctuation">.</span>say <span class="token operator">=</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span> <span class="token comment">// å†™å…¥..</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>configState<span class="token punctuation">.</span>data<span class="token punctuation">.</span>say<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¯»å–..</span>\n<span class="token keyword">delete</span> configState<span class="token punctuation">.</span>data<span class="token punctuation">.</span>say<span class="token punctuation">;</span> <span class="token comment">// åˆ é™¤..</span>\n<span class="token string">&quot;say&quot;</span> <span class="token keyword">in</span> configState<span class="token punctuation">;</span> <span class="token comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨..</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="æ¨¡å‹æ–¹æ³•"><a class="header-anchor" href="#æ¨¡å‹æ–¹æ³•" aria-hidden="true">#</a> æ¨¡å‹æ–¹æ³•</h2><p>åœ¨æ¨¡å‹ç±»ä¸Šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ·»åŠ <strong>ä»»ä½•æ–¹æ³•</strong>å“¦ï¼å°±åƒï¼š</p><div class="language-js line-numbers-mode"><pre><code><span class="token comment">// /models/configState.js</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> Models <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;kurimudb&quot;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ConfigState</span> <span class="token keyword">extends</span> <span class="token class-name">Models<span class="token punctuation">.</span>keyValue</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ..</span>\n\n  <span class="token comment">// æ·»åŠ ä¸€ä¸ªæ¨¡å‹æ–¹æ³•</span>\n  <span class="token function">setFoo</span><span class="token punctuation">(</span><span class="token parameter">bar<span class="token punctuation">,</span> foo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// å„ç§é€»è¾‘..</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>foo <span class="token operator">=</span> foo<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>bar <span class="token operator">=</span> bar<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// æ¨¡å‹çš„æ–¹æ³•ä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„</span>\n  <span class="token keyword">async</span> <span class="token function">calcBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ..</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">ConfigState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>ä½¿ç”¨æ—¶ï¼Œç›´æ¥åœ¨æ¨¡å‹ä¸Šè°ƒç”¨å³å¯ï¼š</p><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">import</span> configState <span class="token keyword">from</span> <span class="token string">&quot;./models/configState.js&quot;</span><span class="token punctuation">;</span>\n\nconfigState<span class="token punctuation">.</span><span class="token function">setFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">await</span> configState<span class="token punctuation">.</span><span class="token function">calcBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="é›†åˆæ¨¡å‹"><a class="header-anchor" href="#é›†åˆæ¨¡å‹" aria-hidden="true">#</a> é›†åˆæ¨¡å‹</h2><p>åœ¨å‰æ–‡ä¸­ï¼Œæˆ‘ä»¬çš„æ¨¡å‹éƒ½æ˜¯é”®å€¼å¯¹æ¨¡å‹ï¼Œå®ƒä»¬ç”¨èµ·æ¥å°±åƒå¯¹è±¡é‚£æ ·ï¼š</p><div class="language-js line-numbers-mode"><pre><code>configState<span class="token punctuation">.</span>data<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æˆ‘ä»¬ä¹Ÿæœ‰æ—¶ï¼Œå¯èƒ½ä¹Ÿéœ€è¦ä¸€ä¸ªä»¥é›†åˆçš„æ–¹å¼ã€æ·»åŠ æ•°æ®æ—¶ä¸»é”®ä¼šè‡ªåŠ¨é€’å¢çš„æ¨¡å‹ï¼Œæœ‰äº›ç±»ä¼¼æ•°ç»„ï¼š</p><div class="language-js line-numbers-mode"><pre><code>configState<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">700</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>é›†åˆæ¨¡å‹å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯å„ç§åˆ—è¡¨ï¼Œæ¯”å¦‚ç¼“å­˜çš„è§†é¢‘åˆ—è¡¨ã€ç”¨æˆ·çš„è‰ç¨¿ç®±åˆ—è¡¨â€¦â€¦ æ¥ä¸‹æ¥ï¼Œå‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªä¾¿ç­¾åº”ç”¨ï¼Œéœ€è¦åœ¨æœ¬åœ°å­˜å‚¨ç”¨æˆ·å†™çš„ä¾¿ç­¾ã€‚</p><p>è®©æˆ‘ä»¬æ¥æ–°å»ºä¸€ä¸ª <code>NoteList</code> æ¨¡å‹ï¼š</p><div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted">Â </div><br><br><br><br><br><br><br><br><br><br></div><pre><code><span class="token comment">// åˆ›å»ºä¸€ä¸ª /models/noteList.js æ–‡ä»¶</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> Models <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;kurimudb&quot;</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ç»§æ‰¿ Models.collection æ¥è®©å®ƒå˜æˆä¸€ä¸ªé›†åˆæ¨¡å‹</span>\n<span class="token keyword">class</span> <span class="token class-name">NoteList</span> <span class="token keyword">extends</span> <span class="token class-name">Models<span class="token punctuation">.</span>collection</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      name<span class="token operator">:</span> <span class="token string">&quot;noteList&quot;</span><span class="token punctuation">,</span>\n      type<span class="token operator">:</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span> <span class="token comment">// é›†åˆæ¨¡å‹çš„ç±»å‹éœ€è¦æ˜¯ number å“¦ï¼</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">NoteList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>ä½¿ç”¨æ—¶ï¼Œé€šè¿‡ <code>insert</code> æ–¹æ³•æ¥åˆ›å»ºçš„æ•°æ®ï¼Œä¸»é”®ä¼šè‡ªå¢ï¼š</p><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">import</span> noteList <span class="token keyword">from</span> <span class="token string">&quot;@/models/noteList&quot;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> note1 <span class="token operator">=</span> noteList<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&quot;This is the content of note 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> note2 <span class="token operator">=</span> noteList<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&quot;This is the content of note 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>noteList<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// echo &quot;This is the content of note 1&quot;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>noteList<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// echo &quot;This is the content of note 2&quot;</span>\n\n<span class="token comment">// è·å–æ¨¡å‹çš„æ‰€æœ‰æ•°æ®..</span>\nnoteList<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>å¤§åŠŸå‘Šæˆå•¦ã€‚</p><div class="tip custom-block"><p class="custom-block-title">å°è´´å£«</p><ol><li>é›†åˆæ¨¡å‹çš„ä¸»é”®æ˜¯ä» <code>1</code> å¼€å§‹é€’å¢çš„ï¼Œè¿™å’Œæ•°ç»„ä¸åŒã€‚è¿™ä¹ˆè®¾è®¡æ˜¯ä¸ºäº†æ›´å¥½çš„å…¼å®¹ IndexedDBï¼Œå› ä¸º IndexedDB æ˜¯ä» <code>1</code> å¼€å§‹çš„ã€‚</li><li>é›†åˆæ¨¡å‹ä¸­ï¼Œåˆ é™¤ä»»æ„å€¼ï¼Œä¸ä¼šå¯¼è‡´å…¶ä»–å€¼çš„ä¸»é”®å˜åŠ¨ï¼Œè¿™å’Œæ•°ç»„ä¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»é”®å¯ä»¥è§†ä¸ºå”¯ä¸€ä¸”ä¸å˜çš„ã€‚</li><li>é›†åˆæ¨¡å‹çš„ä¸»é”®ï¼Œç±»å‹å¿…é¡»æ˜¯ <code>number</code> æ‰è¡Œå“¦ï¼</li></ol></div><h2 id="æ¨¡å‹å¡«å……"><a class="header-anchor" href="#æ¨¡å‹å¡«å……" aria-hidden="true">#</a> æ¨¡å‹å¡«å……</h2><p>æˆ‘ä»¬å¯èƒ½æƒ³ä¸ºä¸€äº›æ¨¡å‹å¡«å……åˆå§‹å€¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨åšä¸€ä¸ªç”µå­ä¹¦åº”ç”¨ï¼Œå¸Œæœ›åœ¨ç”¨æˆ·é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œä¸ºä»–æŒ‡å®šä¸€ä¸ªé»˜è®¤çš„å­—ä½“å¤§å°ã€ä¸»é¢˜ã€ç¿»é¡µæ¨¡å¼â€¦â€¦</p><p>é‚£ä¹ˆå¯ä»¥åœ¨æ¨¡å‹ä¸­çš„æ„é€ æ–¹æ³•ä¸­ï¼Œè°ƒç”¨ <code>seed</code> æ–¹æ³•ï¼Œæ¥å¡«å……åˆå§‹å€¼ï¼š</p><div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br></div><pre><code><span class="token comment">// /models/configState.js</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> Models <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;kurimudb&quot;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ConfigState</span> <span class="token keyword">extends</span> <span class="token class-name">Models<span class="token punctuation">.</span>keyValue</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ..</span>\n\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">seed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">;</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>bar <span class="token operator">=</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>å‘ <code>seed</code> æ–¹æ³•ä¼ é€’çš„é—­åŒ…å‡½æ•°ï¼Œä¼šåœ¨ç”¨æˆ·æ¯æ¬¡è®¿é—®æ­¤é¡µé¢æ—¶ä¼šè¿è¡Œä¸€æ¬¡ã€‚</p><p>å¦‚æœæ¨¡å‹é…ç½®äº†<a href="/persistence.html">å­˜å‚¨é©±åŠ¨</a>ï¼Œé‚£ä¹ˆåªæœ‰åœ¨ç”¨æˆ·é¦–æ¬¡è®¿é—®æ­¤é¡µé¢æ—¶ï¼Œ<code>seed</code> æ–¹æ³•æ‰ä¼šè¿è¡Œä½ ä¼ é€’çš„é—­åŒ…å‡½æ•°ã€‚</p><h2 id="æ·±å…‹éš†"><a class="header-anchor" href="#æ·±å…‹éš†" aria-hidden="true">#</a> æ·±å…‹éš†</h2><p>åœ¨ç»§ç»­æ¢ç´¢ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆèŠèŠ JavaScript ä¸­ä¸€ä¸ªçš„çŸ¥è¯†ï¼šä½ å°†å¯¹è±¡æˆ–æ•°ç»„ï¼Œèµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡æ—¶ï¼Œ<strong>ä¼ é€’çš„å…¶å®æ˜¯åŸå…ˆå˜é‡çš„å¼•ç”¨</strong>ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">let</span> number1 <span class="token operator">=</span> <span class="token number">965</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> number2 <span class="token operator">=</span> number1<span class="token punctuation">;</span>\nnumber1 <span class="token operator">=</span> <span class="token number">996</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>number2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// echo 965</span>\n\n<span class="token keyword">let</span> object1 <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token number">965</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> object2 <span class="token operator">=</span> object1<span class="token punctuation">;</span>\nobject1<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token number">996</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object2<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// echo 996</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>JavaScript çš„è¿™ä¸ªç‰¹æ€§ï¼Œä¼šå¯¼è‡´<strong>å‰¯ä½œç”¨</strong>äº§ç”Ÿï¼Œæˆä¸º bug çš„æ ¹æºã€‚å› æ­¤ï¼Œä¸ºäº†å°½é‡ä¿è¯æ•°æ®çš„ä¸å¯å˜æ€§ï¼Œä½ å‘ Kurimudb å­˜å…¥æ•°æ®æ—¶ï¼Œæˆ‘ä»¬ä¼šæ•°æ®è¿›è¡Œ<strong>æ·±å…‹éš† (deep clone)</strong>ã€‚è¯»å–æ•°æ®æ—¶ï¼Œå®ƒä¸åŸå€¼æ˜¯å®Œå…¨è„±é’©çš„ã€‚</p><p>å¯¹äº <strong>æœ´ç´ å¯¹è±¡ (plain object)</strong> æ¥è¯´ï¼Œæ·±å…‹éš†æ²¡ä»€ä¹ˆå¥½æ‹…å¿ƒçš„ï¼Œä½†å¯¹äºåˆ«çš„å¯¹è±¡ï¼Œå¦‚ <code>new Set(...)</code> æˆ– <code>new Blob(...)</code> ç­‰ï¼Œç”±äºæˆ‘ä»¬åªèƒ½å…‹éš†å…¶<strong>å¯æšä¸¾å±æ€§</strong>ï¼Œæ·±å…‹éš†ä¼šå¯¼è‡´å…¶ä¸¢å¤±å†…å®¹ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä»½ç™½åå•ã€‚å¦‚æœä½ çš„æ•°æ®æˆ–å…¶å†…éƒ¨æœ‰è¿™äº›å¯¹è±¡ï¼Œåˆ™ Kurimudb ä¸ä¼šæ·±å…‹éš†å®ƒä»¬ã€‚</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token punctuation">-</span> Boolean\n<span class="token punctuation">-</span> String\n<span class="token punctuation">-</span> Date\n<span class="token punctuation">-</span> RegExp\n<span class="token punctuation">-</span> Blob\n<span class="token punctuation">-</span> File\n<span class="token punctuation">-</span> FileList\n<span class="token punctuation">-</span> ArrayBuffer\n<span class="token punctuation">-</span> DataView\n<span class="token punctuation">-</span> Uint8ClampedArray\n<span class="token punctuation">-</span> ImageData\n<span class="token punctuation">-</span> Map\n<span class="token punctuation">-</span> Set\n<span class="token punctuation">-</span> Symbol\n<span class="token punctuation">-</span> HTMLDivElement\n<span class="token comment"># é€šè¿‡ `yourObj.constructor.name` æ¥åˆ¤æ–­</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å¦‚æœä½ æƒ³åœ¨æŸä¸ªæ¨¡å‹ä¸­ï¼Œè¦†ç›–è¿™ä»½ç™½åå•ï¼Œä½ å¯ä»¥ï¼š</p><div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted">Â </div><br><br><br><br></div><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Models <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;kurimudb&quot;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ConfigState</span> <span class="token keyword">extends</span> <span class="token class-name">Models<span class="token punctuation">.</span>keyValue</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      name<span class="token operator">:</span> <span class="token string">&quot;configState&quot;</span><span class="token punctuation">,</span>\n      type<span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>\n      intrinsicTypes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;File&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FileList&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>å¦‚æœä½ æƒ³å¯¹ä»»ä½•å¯¹è±¡<strong>éƒ½</strong>è¿›è¡Œæ·±å…‹éš†ï¼Œä½ å¯ä»¥ç›´æ¥ä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ï¼š</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">intrinsicTypes</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚æœä½ æƒ³å¯¹ä»»ä½•å¯¹è±¡<strong>éƒ½ä¸</strong>è¿›è¡Œæ·±å…‹éš†ï¼Œä½ å¯ä»¥ä¼ å…¥ <code>false</code>ï¼š</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">intrinsicTypes</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚æœä½ æƒ³æ‰‹åŠ¨è¿›è¡Œæ·±å…‹éš†ï¼Œä½ å¯ä»¥è°ƒç”¨æ¨¡å‹ä¸Šçš„ <code>deepClone</code> å‡½æ•°ï¼š</p><div class="language-js line-numbers-mode"><pre><code>yourModel<span class="token punctuation">.</span><span class="token function">deepClone</span><span class="token punctuation">(</span>yourOldObject<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="ç±»-storage-api"><a class="header-anchor" href="#ç±»-storage-api" aria-hidden="true">#</a> ç±» Storage Api</h2><p>ä½ è¿˜å¯ä»¥ä½¿ç”¨ç±»ä¼¼ <a href="https://developer.mozilla.org/docs/Web/API/Storage" target="_blank" rel="noopener noreferrer">Storage</a> çš„ Api æ¥å¢åˆ æ”¹æŸ¥æ•°æ®ï¼š</p><div class="language-js line-numbers-mode"><pre><code>local<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;say&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// create it</span>\n<span class="token keyword">let</span> say <span class="token operator">=</span> local<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;say&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// retrieve it</span>\nlocal<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">&quot;say&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// delete it</span>\nlocal<span class="token punctuation">.</span><span class="token function">subscribeItem</span><span class="token punctuation">(</span><span class="token string">&quot;say&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// subscribe it</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>ğŸ“œ ä½¿ç”¨æ­¤åŠŸèƒ½éœ€è¦ (^3.1.2) ç‰ˆæœ¬ã€‚</p></blockquote><h2 id="å…¨éƒ¨æ•°æ®"><a class="header-anchor" href="#å…¨éƒ¨æ•°æ®" aria-hidden="true">#</a> å…¨éƒ¨æ•°æ®</h2><p>è°ƒç”¨ <code>all</code> å‡½æ•°ï¼Œå¯ä»¥è·å–æ­¤æ¨¡å‹çš„å…¨éƒ¨æ•°æ®ã€‚(æ³¨æ„ï¼šå¯¹äºé…ç½®äº† LocalStorage é©±åŠ¨çš„æ¨¡å‹æ¥è¯´ï¼Œæš‚æ—¶æ— æ³•è·å–å…¨éƒ¨æ•°æ®ï¼Œåç»­è¿­ä»£å°†å®Œå–„æ­¤åŠŸèƒ½)</p><div class="language-js line-numbers-mode"><pre><code>yourModel<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div>',58);e.render=function(a,p,e,o,c,l){return n(),s("div",null,[t])};export default e;export{p as __pageData};
